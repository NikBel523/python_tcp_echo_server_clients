# TCP Echo Server and Clients with SQLite Logging

## Описание

Программа реализует TCP-сервер и 10 TCP-клиентов с использованием модуля `asyncio` на Python. 
Сервер принимает соединения от клиентов, отправляет полученные данные обратно и записывает все сообщения в локальную базу данных SQLite.
Клиенты отправляют сообщения серверу через случайные интервалы времени и выводят эхо-ответы в лог.

## Файлы

1. **`db.py`**: Содержит функции для работы с базой данных SQLite.
2. **`client.py`**: Реализует логику TCP-клиента.
3. **`server.py`**: Реализует логику TCP-сервера.
4. **`main.py`**: Основная точка входа в программу, запускающая сервер и клиентов.

## Функциональность

1. **TCP-Сервер:**
   - Принимает TCP-соединения от клиентов.
   - Для каждого нового соединения создается сопрограмма, которая обрабатывает данные от клиента.
   - Сервер записывает каждое полученное сообщение в базу данных SQLite.
   - Закрывает соединение, когда клиент завершает его.

2. **TCP-Клиенты:**
   - Запускаются 10 клиентских сопрограмм.
   - Каждая сопрограмма подключается к серверу и отправляет 5 сообщений с интервалами от 5 до 10 секунд.
   - Клиенты записывают эхо-ответы от сервера в лог и завершаются после отправки всех сообщений.

3. **Локальная база данных:**
   - Используется SQLite для хранения полученных сообщений, адресов клиентов и времени получения сообщений.
   - Таблица `messages` хранит информацию о каждом сообщении.

## Установка

1. **Клонируйте репозиторий:**

    ```bash
    git clone git@github.com:NikBel523/python_tcp_echo_server_clients.git
    cd python_console_library
    ```

2. **Создайте виртуальное окружение (опционально):**
   Linux
    ```bash
    python3 -m venv venv
    source venv/bin/activate
    ```
   Windows
    ```bash
    python -m venv venv
    source venv\Scripts\activate
    ```

3. **Установка зависимостей:**

Убедитесь, что у вас установлен Python 3.7 или новее. Проект не требует установки дополнительных библиотек, кроме стандартных модулей Python.

## Запуск

1. Из директории, куда клонированы файлы, запустите программу с помощью команды:

    ```bash
    python3 main.py
    ```

2. Проверьте файл `messages.db` для просмотра сохраненных сообщений. Вы можете использовать любой SQLite-менеджер или команду `sqlite3` для просмотра содержимого базы данных.

    Для просмотра сообщений в базе данных с использованием командной строки:

    ```bash
    sqlite3 messages.db
    ```

    В интерактивной оболочке `sqlite3` выполните:

    ```sql
    SELECT * FROM messages;
    ```

## Пример Логов

Пример вывода в консоль (лог):

    2024-08-26 12:00:00 - Новое соединение с ('127.0.0.1', 54321)
    
    2024-08-26 12:00:01 - Получено Сообщение 1 от клиента 1 2024-08-26 12:00:01 - Клиент 1 отправляет: Сообщение 1 от клиента 1
    
    2024-08-26 12:00:01 - Клиент 1 получил: Сообщение 1 от клиента 1
    
    2024-08-26 12:00:10 - Клиент 1 закрывает соединение
    
    2024-08-26 12:00:10 - Соединение закрыто клиентом ('127.0.0.1', 54321)

## Примечания

- Убедитесь, что порт 8888 свободен и не занят другими приложениями на вашем устройстве.
- Если необходимо, измените параметры IP-адреса и порта в коде для соответствия вашим требованиям.

<br>

Автор: [Беляков Никита](https://github.com/NikBel523)
